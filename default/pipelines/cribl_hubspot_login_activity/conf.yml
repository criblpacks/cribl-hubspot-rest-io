output: default
streamtags: []
groups:
  SbRroP:
    name: Initial Parsing and Timestamping
    description: Parses the JSON object so that we can start working with the
      fields, sets _time to the correct value
    index: 3
  KsiiV5:
    name: Outputs
    description: Select the output required, if nothing enabled standard JSON will be sent
    index: 4
    disabled: false
asyncFuncTimeout: 1000
functions:
  - id: comment
    filter: "true"
    conf:
      comment: |-
        This conditioning pipeline is for use on the Hubspot REST Events Login Activity API endpoint. The Pack will normalize the JSON data from the collector and provide optional reduction techniques. 

        There are two current available output formats for the data: 
            1. Standard JSON that is formatted and timestamp normalized. 
            3. Splunk, Index and sourcetype can be changed within the pipeline, however default values are set in Knowledge > Variables
  - id: comment
    filter: "true"
    conf:
      comment: For additional details, see this pack's README under Settings.
  - id: comment
    filter: "true"
    conf:
      comment: "Author: Cribl Packs Team"
  - id: serde
    filter: "true"
    disabled: false
    conf:
      mode: extract
      type: json
      srcField: _raw
      fieldFilterExpr: value !== '' && value !== null
      remove: []
      keep: []
    description: Parse the JSON from _raw
    groupId: SbRroP
  - id: eval
    filter: "true"
    disabled: false
    conf:
      remove:
        - _raw
    description: Remove intermediate fields
    groupId: SbRroP
  - id: comment
    filter: "true"
    disabled: false
    conf:
      comment: Output to Splunk
    groupId: KsiiV5
  - id: serialize
    filter: "true"
    disabled: false
    conf:
      type: json
      dstField: _raw
      fields:
        - "!_*"
        - "!cribl*"
        - "!source"
        - "!host"
        - "*"
    groupId: KsiiV5
    description: Serialize JSON to _raw
  - id: eval
    filter: "true"
    disabled: false
    conf:
      add:
        - disabled: false
          value: "index ? index : C.vars['default_splunk_index']"
          name: index
        - disabled: false
          value: "'hubspot:login_activity'"
          name: sourcetype
        - disabled: false
          value: source || C.vars['default_splunk_source']
          name: source
      keep:
        - _*
        - cribl*
        - source
        - host
        - index
        - sourcetype
      remove:
        - "*"
    groupId: KsiiV5
    description: Sets the index and sourcetype for Splunk output
description: Pipeline for parsing, formatting and filtering Hubspot Rest API events.
